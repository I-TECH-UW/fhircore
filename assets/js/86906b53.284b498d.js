"use strict";(self.webpackChunkfhircore=self.webpackChunkfhircore||[]).push([[587],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>m});var o=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=o.createContext({}),s=function(e){var t=o.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},p=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),h=s(r),m=n,d=h["".concat(c,".").concat(m)]||h[m]||u[m]||a;return r?o.createElement(d,l(l({ref:t},p),{},{components:r})):o.createElement(d,l({ref:t},p))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,l=new Array(a);l[0]=h;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:n,l[1]=i;for(var s=2;s<a;s++)l[s]=r[s];return o.createElement.apply(null,l)}return o.createElement.apply(null,r)}h.displayName="MDXCreateElement"},293:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>s});var o=r(7462),n=(r(7294),r(3905));const a={},l=void 0,i={unversionedId:"cql/how-to-convet-cql-to-library-resouce",id:"cql/how-to-convet-cql-to-library-resouce",title:"how-to-convet-cql-to-library-resouce",description:"How do we go about converting a CQL script to a FHIR Library",source:"@site/docs/cql/how-to-convet-cql-to-library-resouce.mdx",sourceDirName:"cql",slug:"/cql/how-to-convet-cql-to-library-resouce",permalink:"/cql/how-to-convet-cql-to-library-resouce",draft:!1,editUrl:"https://github.com/opensrp/fhircore/tree/main/docs/docs/cql/how-to-convet-cql-to-library-resouce.mdx",tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"CQL",permalink:"/cql/"},next:{title:"sample-usage",permalink:"/cql/sample-usage"}},c={},s=[{value:"How do we go about converting a CQL script to a FHIR Library",id:"how-do-we-go-about-converting-a-cql-script-to-a-fhir-library",level:2},{value:"Other possible but not recommended ways to get the translated elm+json",id:"other-possible-but-not-recommended-ways-to-get-the-translated-elmjson",level:2}],p={toc:s};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h2",{id:"how-do-we-go-about-converting-a-cql-script-to-a-fhir-library"},"How do we go about converting a CQL script to a FHIR Library"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Android FHIR SDK CQL Builder")),(0,n.kt)("p",null,"SDK workflow testing module has ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/google/android-fhir/blob/master/workflow-testing/src/main/java/com/google/android/fhir/workflow/testing/CqlBuilder.kt"},"com.google.android.fhir.workflow.testing.CqlBuilder")," which can do translation from a ",(0,n.kt)("inlineCode",{parentName:"p"},"CQL")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"Library")," resource. This automatically does the ",(0,n.kt)("inlineCode",{parentName:"p"},"elm")," conversion for you internally. "),(0,n.kt)("p",null,"An example usage can be seen in tests found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/google/android-fhir/blob/master/workflow/src/test/java/com/google/android/fhir/workflow/FhirOperatorTest.kt#L150"},"here")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"val library = CqlBuilder.compileAndBuild(cqlScriptInputStream)\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"FHIR Core CQL Testing Module")),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing"},"fhir-resources")," repository has a testing module which allows to not only get the complete Library resource to directly save to the server but also allows to test the output and make changes on the fly. Check the cucumber tests ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/resources/measure-report/household-members.feature"},"Feature File"),", the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/kotlin/com/fhircore/resources/testing/measure/HouseholdMembersMeasureTest.kt#L28"},"Test Code File")," and the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/kotlin/com/fhircore/resources/testing/CqlUtils.kt"},"Convertor Util Method")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"FHIR Core Tooling Library")),(0,n.kt)("p",null,"FHIR Core tooling library can also be used to get a Library by running the command below. Details on the tool can be found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhircore-tooling#converting-library-cql-to-json"},"here"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"fct convert -t cql -i /some/path/Patient-1.0.0.cql\n")),(0,n.kt)("h2",{id:"other-possible-but-not-recommended-ways-to-get-the-translated-elmjson"},"Other possible but not recommended ways to get the translated elm+json"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"1. CQL to ELM REST Translator")),(0,n.kt)("p",null,"A ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/cql-translation-service/blob/master/README.md"},"elm REST app")," that can be used to run elm microservice and convert CQL via a REST API."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"2. CQL to ELM JAVA Translator")),(0,n.kt)("p",null,"Her is an ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/READM.md"},"elm java app")," that can be used as an elm translator on related files and get an output. Instructions can be found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/cql-execution#to-execute-your-cql"},"here")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"NB")," : The above approaches output a ",(0,n.kt)("inlineCode",{parentName:"p"},"json-elm")," which then needs to be Base64 decoded and copied to the ",(0,n.kt)("a",{parentName:"p",href:"http://hl7.org/fhir/R4/library.html"},"Library")," content as Attachment."))}u.isMDXComponent=!0}}]);