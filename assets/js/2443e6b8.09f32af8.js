"use strict";(self.webpackChunkfhircore=self.webpackChunkfhircore||[]).push([[855],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>d});var o=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},a=Object.keys(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var c=o.createContext({}),s=function(e){var t=o.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=s(e.components);return o.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),h=s(r),d=n,m=h["".concat(c,".").concat(d)]||h[d]||u[d]||a;return r?o.createElement(m,i(i({ref:t},p),{},{components:r})):o.createElement(m,i({ref:t},p))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,i=new Array(a);i[0]=h;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var s=2;s<a;s++)i[s]=r[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}h.displayName="MDXCreateElement"},2467:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var o=r(7462),n=(r(7294),r(3905));const a={},i="Converting CQL to a library",l={unversionedId:"writing-fhir/cql/convert-cql-to-library",id:"writing-fhir/cql/convert-cql-to-library",title:"Converting CQL to a library",description:"This document discusses how to convert a CQL script to a FHIR library.",source:"@site/docs/writing-fhir/cql/convert-cql-to-library.mdx",sourceDirName:"writing-fhir/cql",slug:"/writing-fhir/cql/convert-cql-to-library",permalink:"/writing-fhir/cql/convert-cql-to-library",draft:!1,editUrl:"https://github.com/opensrp/fhircore/tree/main/docs/docs/writing-fhir/cql/convert-cql-to-library.mdx",tags:[],version:"current",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"CQL",permalink:"/writing-fhir/cql/"},next:{title:"CQL use cases",permalink:"/writing-fhir/cql/sample-usage"}},c={},s=[{value:"Android FHIR SDK CQL Builder",id:"android-fhir-sdk-cql-builder",level:2},{value:"FHIR Core CQL Testing Module",id:"fhir-core-cql-testing-module",level:2},{value:"FHIR Core Tooling Library",id:"fhir-core-tooling-library",level:2},{value:"Unrecommended conversion methods",id:"unrecommended-conversion-methods",level:2},{value:"CQL to ELM REST Translator",id:"cql-to-elm-rest-translator",level:3},{value:"CQL to ELM JAVA Translator",id:"cql-to-elm-java-translator",level:3}],p={toc:s};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"converting-cql-to-a-library"},"Converting CQL to a library"),(0,n.kt)("p",null,"This document discusses how to convert a CQL script to a FHIR library."),(0,n.kt)("h2",{id:"android-fhir-sdk-cql-builder"},"Android FHIR SDK CQL Builder"),(0,n.kt)("p",null,"SDK workflow testing module has ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/google/android-fhir/blob/master/workflow-testing/src/main/java/com/google/android/fhir/workflow/testing/CqlBuilder.kt"},(0,n.kt)("inlineCode",{parentName:"a"},"com.google.android.fhir.workflow.testing.CqlBuilder"))," which can do translation from a ",(0,n.kt)("inlineCode",{parentName:"p"},"CQL")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"Library")," resource. This automatically does the ",(0,n.kt)("inlineCode",{parentName:"p"},"elm")," conversion for you internally."),(0,n.kt)("p",null,"An example usage can be seen in tests found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/google/android-fhir/blob/master/workflow/src/test/java/com/google/android/fhir/workflow/FhirOperatorTest.kt#L150"},"here")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"val library = CqlBuilder.compileAndBuild(cqlScriptInputStream)\n")),(0,n.kt)("h2",{id:"fhir-core-cql-testing-module"},"FHIR Core CQL Testing Module"),(0,n.kt)("p",null,"The ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing"},"fhir-resources")," repository has a testing module which allows to not only get the complete Library resource to directly save to the server but also allows to test the output and make changes on the fly. Check the cucumber tests ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/resources/measure-report/household-members.feature"},"Feature File"),", the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/kotlin/com/fhircore/resources/testing/measure/HouseholdMembersMeasureTest.kt#L28"},"Test Code File")," and the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhir-resources/blob/main/fhircore-testing/fhircore-tests/src/androidTest/kotlin/com/fhircore/resources/testing/CqlUtils.kt"},"Convertor Util Method")),(0,n.kt)("h2",{id:"fhir-core-tooling-library"},"FHIR Core Tooling Library"),(0,n.kt)("p",null,"FHIR Core tooling library can also be used to get a Library by running the command below. Details on the tool can be found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/opensrp/fhircore-tooling#converting-library-cql-to-json"},"here"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"fct convert -t cql -i /some/path/Patient-1.0.0.cql\n")),(0,n.kt)("h2",{id:"unrecommended-conversion-methods"},"Unrecommended conversion methods"),(0,n.kt)("p",null,"These are other methods to convert a CQL script to elm+json."),(0,n.kt)("admonition",{type:"info"},(0,n.kt)("p",{parentName:"admonition"},"The below approaches output a ",(0,n.kt)("inlineCode",{parentName:"p"},"json-elm")," which then needs to be Base64 decoded and copied to the ",(0,n.kt)("a",{parentName:"p",href:"http://hl7.org/fhir/R4/library.html"},"Library")," content as Attachment.")),(0,n.kt)("h3",{id:"cql-to-elm-rest-translator"},"CQL to ELM REST Translator"),(0,n.kt)("p",null,"A ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/cql-translation-service/blob/master/README.md"},"elm REST app")," that can be used to run elm microservice and convert CQL via a REST API."),(0,n.kt)("h3",{id:"cql-to-elm-java-translator"},"CQL to ELM JAVA Translator"),(0,n.kt)("p",null,"Her is an ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/clinical_quality_language/blob/master/Src/java/READM.md"},"elm java app")," that can be used as an elm translator on related files and get an output. Instructions can be found ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/cqframework/cql-execution#to-execute-your-cql"},"here")))}u.isMDXComponent=!0}}]);