{
    "resourceType": "PlanDefinition",
    "id": "346",
    "meta": {
      "versionId": "2",
      "lastUpdated": "2022-10-24T11:23:27.177+00:00",
      "source": "#Fldu8DELB9w8VxH3"
    },
    "contained": [
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-activity",
        "title": "ANC Follow Up Plan",
        "status": "active",
        "description": "This action will performed every month for a pregnant woman",
        "kind": "Task",
        "timingTiming": {
          "repeat": {
            "countMax": 8,
            "duration": 2,
            "durationMax": 4,
            "durationUnit": "h",
            "frequency": 1,
            "frequencyMax": 1,
            "period": 1,
            "periodMax": 1,
            "periodUnit": "mo"
          }
        }
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-followup-activity",
        "title": "ANC Follow Up Handler Activity",
        "status": "active",
        "description": "This action will assess careplan every time a followup happens on a task generated by plan",
        "kind": "CarePlan",
        "dynamicValue": [
          {
            "path": "CarePlan.status",
            "expression": {
              "language": "text/fhirpath",
              "expression": "'completed'"
            }
          }
        ]
      },
      {
        "resourceType": "ActivityDefinition",
        "id": "careplan-referral-activity",
        "title": "ANC Referral Handler Activity",
        "status": "active",
        "description": "This action will assess careplan and generate referral task every time a followup happens on a task generated by plan",
        "kind": "Task"
      }
    ],
    "name": "ANC Follow Up Plan",
    "title": "ANC Follow Up Plan",
    "status": "active",
    "description": "This defines the schedule of care for pregnant women",
    "goal": [
      {
        "category": {
          "coding": [
            {
              "system": "https://www.hl7.org/fhir/codesystem-goal-category.html",
              "code": "nursing",
              "display": "Nursing"
            }
          ]
        },
        "priority": {
          "coding": [
            {
              "system": "https://www.hl7.org/fhir/codesystem-goal-priority.html",
              "code": "high-priority",
              "display": "High Priority"
            }
          ]
        },
        "start": {
          "coding": [
            {
              "system": "http://www.snomed.org/",
              "code": "32485007",
              "display": "Admission to hospital"
            }
          ]
        }
      }
    ],
    "action": [
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.where(questionnaire = 'Questionnaire/343').exists()"
            }
          }
        ],
        "participant": [
          {
            "type": "practitioner",
            "role": {
              "coding": [
                {
                  "system": "http://terminology.hl7.org/CodeSystem/practitioner-role",
                  "code": "nurse",
                  "display": "Nurse"
                }
              ]
            }
          }
        ],
        "type": {
          "coding": [
            {
              "code": "clinical-protocol",
              "display": "Clinical Protocol"
            }
          ]
        },
        "definitionCanonical": "#careplan-activity",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/363"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and %resource.entry.where(resource is QuestionnaireResponse).resource.questionnaire = 'Questionnaire/345'"
            }
          }
        ],
        "definitionCanonical": "#careplan-followup-activity"
      },
      {
        "prefix": "1",
        "priority": "routine",
        "condition": [
          {
            "kind": "applicability",
            "expression": {
              "language": "text/fhirpath",
              "expression": "$this is Patient and $this.birthDate < today() - 5 'years' and %resource.entry.where(resource is QuestionnaireResponse).resource.descendants().where(linkId='9b486fa3-5323-47db-c8eb-f725fb50e8d6' and answer.value.code='yes').exists()"
            }
          }
        ],
        "definitionCanonical": "#careplan-referral-activity",
        "transform": "http://fhir.mpower-social.com:7070/fhir/StructureMap/344"
      }
    ]
  }