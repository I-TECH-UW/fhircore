{
  "resourceType": "Questionnaire",
  "id": "phone-tracing-outcome",
  "language": "en",
  "extension": [
    {
      "url": "http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-targetStructureMap",
      "valueCanonical": "https://fhir-dev.d-tree.org/StructureMap/phone-tracing-outcome"
    }
  ],
  "title": "Phone Tracing Outcome",
  "status": "active",
  "publisher": "mcore",
  "contact": [
    {
      "name": "http://www.d-tree.org"
    }
  ],
  "item": [
    {
      "linkId": "is-tracing-conducted",
      "text": "Were you able to speak to the client?",
      "type": "boolean",
      "required": true
    },
    {
      "linkId": "conducted-group",
      "type": "group",
      "enableWhen": [
        {
          "question": "is-tracing-conducted",
          "operator": "=",
          "answerBoolean": true
        }
      ],
      "enableBehavior": "all",
      "item": [
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "system": "http://hl7.org/fhir/questionnaire-item-control",
                    "code": "drop-down",
                    "display": "Drop down"
                  }
                ],
                "text": "Drop down"
              }
            }
          ],
          "linkId": "tracing-outcome",
          "type": "choice",
          "text": "Select Outcome of Discussion",
          "required": true,
          "answerOption": [
            {
              "valueCoding": {
                "code": "patient-will-return",
                "display": "They will return"
              }
            },
            {
              "valueCoding": {
                "code": "vl-and-iac",
                "display": "Provided VL results and IAC"
              }
            },
            {
              "valueCoding": {
                "code": "transfer-out",
                "display": "Transfer Out"
              }
            },
            {
              "valueCoding": {
                "code": "patient-refused-visit",
                "display": "Requested home visit"
              }
            },
            {
              "valueCoding": {
                "code": "patient-refused-return",
                "display": "Refused to return"
              }
            }
          ]
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/minValue",
              "_valueDate": {
                "extension": [
                  {
                    "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                    "valueExpression": {
                      "language": "text/fhirpath",
                      "expression": "today()"
                    }
                  }
                ]
              }
            }
          ],
          "linkId": "date-of-agreed-appointment",
          "text": "<b>ENTER</b> Date of agreed clinic Appointment",
          "type": "date",
          "enableWhen": [
            {
              "question": "tracing-outcome",
              "operator": "=",
              "answerCoding": {
                "code": "patient-will-return"
              }
            }
          ],
          "enableBehavior": "all",
          "required": true
        },
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/maxValue",
              "_valueDate": {
                "extension": [
                  {
                    "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                    "valueExpression": {
                      "language": "text/fhirpath",
                      "expression": "today()"
                    }
                  }
                ]
              }
            }
          ],
          "linkId": "date-of-iac",
          "text": "<b>ENTER</b> Date of IAC was provided",
          "type": "date",
          "enableWhen": [
            {
              "question": "tracing-outcome",
              "operator": "=",
              "answerCoding": {
                "code": "vl-and-iac"
              }
            }
          ],
          "enableBehavior": "all",
          "required": true
        },
        {
          "linkId": "transfered-group",
          "type": "group",
          "enableWhen": [
            {
              "question": "tracing-outcome",
              "operator": "=",
              "answerCoding": {
                "code": "transfer-out"
              }
            }
          ],
          "enableBehavior": "all",
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/maxValue",
                  "_valueDate": {
                    "extension": [
                      {
                        "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                        "valueExpression": {
                          "language": "text/fhirpath",
                          "expression": "today()"
                        }
                      }
                    ]
                  }
                }
              ],
              "linkId": "date-of-agreed-appointment",
              "text": "<b>ENTER</b> Date of agreed clinic Appointment",
              "type": "date",
              "required": true
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "district",
              "text": "Where did they transfer to? <b>Select</b> District",
              "type": "choice",
              "required": true,
              "enableWhen": [
                {
                  "question": "tracing-outcome",
                  "operator": "=",
                  "answerCoding": {
                    "code": "transfer-out"
                  }
                }
              ],
              "enableBehavior": "all",
              "answerOption": [
                {
                  "valueString": "Balaka"
                },
                {
                  "valueString": "Blantyre"
                },
                {
                  "valueString": "Chikwawa"
                },
                {
                  "valueString": "Chiradzulu"
                },
                {
                  "valueString": "Chitipa"
                },
                {
                  "valueString": "Dedza"
                },
                {
                  "valueString": "Dowa"
                },
                {
                  "valueString": "Karonga"
                },
                {
                  "valueString": "Kasungu"
                },
                {
                  "valueString": "Likoma"
                },
                {
                  "valueString": "Lilongwe"
                },
                {
                  "valueString": "Machinga"
                },
                {
                  "valueString": "Mangochi"
                },
                {
                  "valueString": "Mchinji"
                },
                {
                  "valueString": "Mozambique"
                },
                {
                  "valueString": "Mulanje"
                },
                {
                  "valueString": "Mwanza"
                },
                {
                  "valueString": "Mzimba"
                },
                {
                  "valueString": "Neno"
                },
                {
                  "valueString": "Nkhata Bay"
                },
                {
                  "valueString": "Nkhotakota"
                },
                {
                  "valueString": "Nsanje"
                },
                {
                  "valueString": "Ntcheu"
                },
                {
                  "valueString": "Ntchisi"
                },
                {
                  "valueString": "Phalombe"
                },
                {
                  "valueString": "Rumphi"
                },
                {
                  "valueString": "Salima"
                },
                {
                  "valueString": "Thyolo"
                },
                {
                  "valueString": "Zomba"
                }
              ]
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "tracing-catchment-balaka",
              "text": "* <b>SELECT</b> Tracing Catchment",
              "type": "choice",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Balaka"
                }
              ],
              "enableBehavior": "any",
              "required": true,
              "answerOption": [
                {
                  "valueString": "Adamu"
                },
                {
                  "valueString": "Amonitsute"
                },
                {
                  "valueString": "Bulusi"
                },
                {
                  "valueString": "Chauluka"
                },
                {
                  "valueString": "Chidalala"
                },
                {
                  "valueString": "Chikalogwe"
                },
                {
                  "valueString": "Chikololele"
                },
                {
                  "valueString": "Chikuse"
                },
                {
                  "valueString": "Chimatiro"
                },
                {
                  "valueString": "Chimkwakwa"
                },
                {
                  "valueString": "Chimpakati"
                },
                {
                  "valueString": "Chimtendere"
                },
                {
                  "valueString": "Chingagwe"
                },
                {
                  "valueString": "Chipochera"
                },
                {
                  "valueString": "Chitala"
                },
                {
                  "valueString": "Chiyembekezo"
                },
                {
                  "valueString": "Damu"
                },
                {
                  "valueString": "Domoka"
                },
                {
                  "valueString": "Hanjahanja"
                },
                {
                  "valueString": "James"
                },
                {
                  "valueString": "Joshua"
                },
                {
                  "valueString": "Kachikuni"
                },
                {
                  "valueString": "Kadyalunda"
                },
                {
                  "valueString": "Kalimba"
                },
                {
                  "valueString": "Kampeni"
                },
                {
                  "valueString": "Kandengwe"
                },
                {
                  "valueString": "Kanyumbaaka"
                },
                {
                  "valueString": "Kapalamula"
                },
                {
                  "valueString": "Kapire"
                },
                {
                  "valueString": "Katuma"
                },
                {
                  "valueString": "Kaumphawi"
                },
                {
                  "valueString": "Kayinga"
                },
                {
                  "valueString": "Khoswe"
                },
                {
                  "valueString": "Khwalala"
                },
                {
                  "valueString": "Khwisa"
                },
                {
                  "valueString": "Liwiza"
                },
                {
                  "valueString": "Liwonde"
                },
                {
                  "valueString": "Lupanga"
                },
                {
                  "valueString": "Mackenzie"
                },
                {
                  "valueString": "Majawa"
                },
                {
                  "valueString": "Majo"
                },
                {
                  "valueString": "Makoloje"
                },
                {
                  "valueString": "Maliwata"
                },
                {
                  "valueString": "Matola"
                },
                {
                  "valueString": "Mbodzoole"
                },
                {
                  "valueString": "Mchenga"
                },
                {
                  "valueString": "Mchirakwenda"
                },
                {
                  "valueString": "Mgwira"
                },
                {
                  "valueString": "Mitochi"
                },
                {
                  "valueString": "Mlandula"
                },
                {
                  "valueString": "M'Manga"
                },
                {
                  "valueString": "Mpezeni"
                },
                {
                  "valueString": "Mponda"
                },
                {
                  "valueString": "Mpoto"
                },
                {
                  "valueString": "Mpulula"
                },
                {
                  "valueString": "Mtalika"
                },
                {
                  "valueString": "Mwalero"
                },
                {
                  "valueString": "Mzati"
                },
                {
                  "valueString": "Ngomano"
                },
                {
                  "valueString": "Ng'Onga"
                },
                {
                  "valueString": "Ngwalo"
                },
                {
                  "valueString": "Njede"
                },
                {
                  "valueString": "Ntonya"
                },
                {
                  "valueString": "Petulo"
                },
                {
                  "valueString": "Phalula"
                },
                {
                  "valueString": "Pilitu"
                },
                {
                  "valueString": "Sawali"
                },
                {
                  "valueString": "Siliya"
                },
                {
                  "valueString": "Sosola"
                },
                {
                  "valueString": "Tembo"
                },
                {
                  "valueString": "Toleza"
                },
                {
                  "valueString": "Uli"
                },
                {
                  "valueString": "Zammimba"
                }
              ]
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "tracing-catchment-machinga",
              "text": "* <b>SELECT</b> Tracing Catchment",
              "type": "choice",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Machinga"
                }
              ],
              "enableBehavior": "any",
              "required": true,
              "answerOption": [
                {
                  "valueString": "Chamba Dispensary"
                }
              ]
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "tracing-catchment-mangochi",
              "text": "* <b>SELECT</b> Tracing Catchment",
              "type": "choice",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Mangochi"
                }
              ],
              "enableBehavior": "any",
              "required": true,
              "answerOption": [
                {
                  "valueString": "Assalaam Clinic"
                }
              ]
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "tracing-catchment-phalombe",
              "text": "* <b>SELECT</b> Tracing Catchment",
              "type": "choice",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Phalombe"
                }
              ],
              "enableBehavior": "any",
              "required": true,
              "answerOption": [
                {
                  "valueString": "Chiringa Maternity"
                }
              ]
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
                  "valueCodeableConcept": {
                    "coding": [
                      {
                        "system": "http://hl7.org/fhir/questionnaire-item-control",
                        "code": "drop-down",
                        "display": "Drop down"
                      }
                    ],
                    "text": "Drop down"
                  }
                }
              ],
              "linkId": "tracing-catchment-salima",
              "text": "* <b>SELECT</b> Tracing Catchment",
              "type": "choice",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Salima"
                }
              ],
              "enableBehavior": "any",
              "required": true,
              "answerOption": [
                {
                  "valueString": "Chinguluwe Health Centre"
                }
              ]
            },
            {
              "linkId": "document-out",
              "type": "display",
              "text": "<h1>Action: Notify site supervisor to alert the other site to enter the client in their appointment register</h1>",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Balaka"
                },
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Machinga"
                },
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Mangochi"
                },
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Phalombe"
                },
                {
                  "question": "district",
                  "operator": "=",
                  "answerString": "Salima"
                }
              ],
              "enableBehavior": "any"
            },
            {
              "linkId": "document-out",
              "type": "display",
              "text": "<h1>Write: date of Transfer out in the EMR, Master Card and ART Facility Register</h1>",
              "enableWhen": [
                {
                  "question": "district",
                  "operator": "exists",
                  "answerBoolean": true
                }
              ],
              "enableBehavior": "all"
            }
          ]
        },
        {
          "linkId": "refused-visit-group",
          "type": "group",
          "enableWhen": [
            {
              "question": "tracing-outcome",
              "operator": "=",
              "answerCoding": {
                "code": "patient-refused-visit"
              }
            }
          ],
          "enableBehavior": "all",
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/minValue",
                  "_valueDate": {
                    "extension": [
                      {
                        "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                        "valueExpression": {
                          "language": "text/fhirpath",
                          "expression": "today()"
                        }
                      }
                    ]
                  }
                }
              ],
              "linkId": "date-of-visit",
              "text": "<b>ENTER</b> Date of home visit",
              "type": "date",
              "required": true
            },
            {
              "linkId": "doc-out",
              "type": "display",
              "text": "<h1>This person will be added to the home tracing list</h1>",
              "enableWhen": [
                {
                  "question": "date-of-visit",
                  "operator": "exists",
                  "answerBoolean": true
                }
              ],
              "enableBehavior": "any"
            }
          ]
        },
        {
          "linkId": "refused-group",
          "type": "group",
          "enableWhen": [
            {
              "question": "tracing-outcome",
              "operator": "=",
              "answerCoding": {
                "code": "patient-refused-return"
              }
            }
          ],
          "enableBehavior": "all",
          "item": [
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/maxValue",
                  "_valueDate": {
                    "extension": [
                      {
                        "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                        "valueExpression": {
                          "language": "text/fhirpath",
                          "expression": "today()"
                        }
                      }
                    ]
                  }
                }
              ],
              "linkId": "date-of-refusal",
              "text": "<b>ENTER</b> Date of refusal",
              "type": "date",
              "required": true
            },
            {
              "linkId": "psychosocial-counselling",
              "type": "boolean",
              "required": true,
              "text": "Did the patient agree to speak with a psychosocial counsellor?"
            },
            {
              "linkId": "notify-supervisor-yes",
              "type": "display",
              "text": "<h1>Notify the Site Supervisor of this patient's refusal to return and willingness to speak to a psychosocial counsellor</h1>",
              "enableWhen": [
                {
                  "question": "psychosocial-counselling",
                  "operator": "=",
                  "answerBoolean": true
                }
              ],
              "enableBehavior": "any"
            },
            {
              "linkId": "notify-supervisor-no",
              "type": "display",
              "text": "<h1>Notify the Site Supervisor of this patient's refusal to return and refusal to speak to a psychosocial counsellor</h1>",
              "enableWhen": [
                {
                  "question": "psychosocial-counselling",
                  "operator": "=",
                  "answerBoolean": false
                }
              ],
              "enableBehavior": "any"
            }
          ]
        }
      ]
    },
    {
      "linkId": "not-conducted-group",
      "type": "group",
      "enableWhen": [
        {
          "question": "is-tracing-conducted",
          "operator": "=",
          "answerBoolean": false
        }
      ],
      "enableBehavior": "all",
      "item": [
        {
          "extension": [
            {
              "url": "http://hl7.org/fhir/StructureDefinition/questionnaire-itemControl",
              "valueCodeableConcept": {
                "coding": [
                  {
                    "system": "http://hl7.org/fhir/questionnaire-item-control",
                    "code": "drop-down",
                    "display": "Drop down"
                  }
                ],
                "text": "Drop down"
              }
            }
          ],
          "linkId": "reason-for-no-tracing",
          "type": "choice",
          "required": true,
          "text": "Select the reason you were unable to speak to the client",
          "answerOption": [
            {
              "valueCoding": {
                "code": "phone-busy",
                "display": "Phone Busy"
              }
            },
            {
              "valueCoding": {
                "code": "no-answer",
                "display": "Phone Rang But No Answer"
              }
            },
            {
              "valueCoding": {
                "code": "patient-busy",
                "display": "They were busy"
              }
            },
            {
              "valueCoding": {
                "code": "wrong-number",
                "display": "Wrong Number"
              }
            },
            {
              "valueCoding": {
                "code": "number-doesnt-exist",
                "display": "Number Does Not Exist"
              }
            },
            {
              "valueCoding": {
                "code": "deceased",
                "display": "Deceased"
              }
            },
            {
              "valueCoding": {
                "code": "no-tracing-required",
                "display": "Error, this person does not require tracing"
              }
            }
          ]
        },
        {
          "linkId": "call-again",
          "type": "display",
          "text": "<h1>Action: Call the patient at a different time</h1>",
          "enableWhen": [
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "phone-busy"
              }
            },
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "no-answer"
              }
            },
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "patient-busy"
              }
            }
          ],
          "enableBehavior": "any"
        },
        {
          "linkId": "remove-phone",
          "type": "display",
          "text": "<h1>This person will be removed from the phone tracing list and added to the home tracing list</h1>",
          "enableWhen": [
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "wrong-number"
              }
            },
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "number-doesnt-exist"
              }
            }
          ],
          "enableBehavior": "any"
        },
        {
          "linkId": "deceased-group",
          "type": "group",
          "enableWhen": [
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "deceased"
              }
            }
          ],
          "enableBehavior": "all",
          "item": [
            {
              "linkId": "death-date-known",
              "type": "boolean",
              "text": "Do you know when they died?"
            },
            {
              "extension": [
                {
                  "url": "http://hl7.org/fhir/StructureDefinition/maxValue",
                  "_valueDate": {
                    "extension": [
                      {
                        "url": "http://hl7.org/fhir/StructureDefinition/cqf-calculatedValue",
                        "valueExpression": {
                          "language": "text/fhirpath",
                          "expression": "today()"
                        }
                      }
                    ]
                  }
                }
              ],
              "linkId": "date-of-death",
              "text": "<b>ENTER:</b> date of death",
              "type": "date",
              "required": true,
              "enableWhen": [
                {
                  "question": "death-date-known",
                  "operator": "=",
                  "answerBoolean": true
                }
              ],
              "enableBehavior": "all"
            },
            {
              "linkId": "patient-to-remove",
              "type": "display",
              "text": "<h1>This person will be removed from the client list</h1>",
              "enableWhen": [
                {
                  "question": "death-date-known",
                  "operator": "=",
                  "answerBoolean": false
                },
                {
                  "question": "date-of-death",
                  "operator": "exists",
                  "answerBoolean": true
                }
              ],
              "enableBehavior": "any"
            }
          ]
        },
        {
          "linkId": "does-not-require-tracing",
          "type": "display",
          "text": "<h1>This person will be removed from the tracing list</h1>",
          "enableWhen": [
            {
              "question": "reason-for-no-tracing",
              "operator": "=",
              "answerCoding": {
                "code": "no-tracing-required"
              }
            }
          ],
          "enableBehavior": "any"
        }
      ]
    }
  ]
}
